–
EC:\Users\danie\source\repos\prueba2P-Pruebas\Prueba\Prueba\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
Env 
. 
Load 
( 	
)	 

;
 
var		 
dbServer		 
=		 
Environment		 
.		 "
GetEnvironmentVariable		 1
(		1 2
$str		2 =
)		= >
;		> ?
var

 

dbDatabase

 
=

 
Environment

 
.

 "
GetEnvironmentVariable

 3
(

3 4
$str

4 A
)

A B
;

B C
var 
dbUser 

= 
Environment 
. "
GetEnvironmentVariable /
(/ 0
$str0 9
)9 :
;: ;
var 

dbPassword 
= 
Environment 
. "
GetEnvironmentVariable 3
(3 4
$str4 A
)A B
;B C
var 
connectionString 
= 
$" 
$str  
{  !
dbServer! )
}) *
$str* +
"+ ,
+- .
$" 
$str "
{" #

dbDatabase# -
}- .
$str. /
"/ 0
+1 2
$" 
$str !
{! "
dbUser" (
}( )
$str) *
"* +
+, -
$" 
$str "
{" #

dbPassword# -
}- .
$str. /
"/ 0
+1 2
$" 
$str S
"S T
;T U
builder 
. 
Configuration 
[ 
$str ;
]; <
== >
connectionString? O
;O P
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddDbContext 
< 
AppDBContext *
>* +
(+ ,
options, 3
=>4 6
options7 >
.> ?
UseSqlServer? K
(K L
builderL S
.S T
ConfigurationT a
.a b
GetConnectionStringb u
(u v
$str	v ‰
)
‰ Š
)
Š ‹
)
‹ Œ
;
Œ 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app   
.   

UseSwagger   
(   
)   
;   
app!! 
.!! 
UseSwaggerUI!! 
(!! 
)!! 
;!! 
}"" 
app$$ 
.$$ 
UseHttpsRedirection$$ 
($$ 
)$$ 
;$$ 
app&& 
.&& 
UseAuthorization&& 
(&& 
)&& 
;&& 
app(( 
.(( 
MapControllers(( 
((( 
)(( 
;(( 
await** 
app** 	
.**	 

RunAsync**
 
(** 
)** 
;** ƒl
eC:\Users\danie\source\repos\prueba2P-Pruebas\Prueba\Prueba\Migrations\20250120225657_InitalCreate3.cs
	namespace 	
Prueba
 
. 

Migrations 
{ 
public		 

partial		 
class		 
InitalCreate3		 &
:		' (
	Migration		) 2
{

 
public 
const 
string 
nvarChar $
=% &
$str' 6
;6 7
public 
const 
string 
sql 
=  !
$str" 6
;6 7
public 
const 
string 
reserva #
=$ %
$str& 0
;0 1
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
sql$ '
,' (
$str) /
)/ 0
,0 1
Nombre 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
nvarChar8 @
,@ A
nullableB J
:J K
falseL Q
)Q R
,R S
Apellido 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
nvarChar: B
,B C
nullableD L
:L M
falseN S
)S T
,T U
Edad 
= 
table  
.  !
Column! '
<' (
int( +
>+ ,
(, -
type- 1
:1 2
$str3 8
,8 9
nullable: B
:B C
trueD H
)H I
,I J
Cedula 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
nvarChar8 @
,@ A
nullableB J
:J K
falseL Q
)Q R
} 
, 
constraints 
: 
table "
=># %
{ 
table   
.   

PrimaryKey   $
(  $ %
$str  % 2
,  2 3
x  4 5
=>  6 8
x  9 :
.  : ;
Id  ; =
)  = >
;  > ?
}!! 
)!! 
;!! 
migrationBuilder## 
.## 
CreateTable## (
(##( )
name$$ 
:$$ 
$str$$ $
,$$$ %
columns%% 
:%% 
table%% 
=>%% !
new%%" %
{&& 
Id'' 
='' 
table'' 
.'' 
Column'' %
<''% &
int''& )
>'') *
(''* +
type''+ /
:''/ 0
$str''1 6
,''6 7
nullable''8 @
:''@ A
false''B G
)''G H
.(( 

Annotation(( #
(((# $
sql(($ '
,((' (
$str(() /
)((/ 0
,((0 1
	Capacidad)) 
=)) 
table))  %
.))% &
Column))& ,
<)), -
int))- 0
>))0 1
())1 2
type))2 6
:))6 7
$str))8 =
,))= >
nullable))? G
:))G H
true))I M
)))M N
,))N O
NumeroDeHabitacion** &
=**' (
table**) .
.**. /
Column**/ 5
<**5 6
int**6 9
>**9 :
(**: ;
type**; ?
:**? @
$str**A F
,**F G
nullable**H P
:**P Q
true**R V
)**V W
,**W X
Costo++ 
=++ 
table++ !
.++! "
Column++" (
<++( )
decimal++) 0
>++0 1
(++1 2
type++2 6
:++6 7
$str++8 G
,++G H
nullable++I Q
:++Q R
false++S X
)++X Y
,++Y Z
Piso,, 
=,, 
table,,  
.,,  !
Column,,! '
<,,' (
int,,( +
>,,+ ,
(,,, -
type,,- 1
:,,1 2
$str,,3 8
,,,8 9
nullable,,: B
:,,B C
true,,D H
),,H I
,,,I J
Lugar-- 
=-- 
table-- !
.--! "
Column--" (
<--( )
string--) /
>--/ 0
(--0 1
type--1 5
:--5 6
nvarChar--7 ?
,--? @
nullable--A I
:--I J
false--K P
)--P Q
}.. 
,.. 
constraints// 
:// 
table// "
=>//# %
{00 
table11 
.11 

PrimaryKey11 $
(11$ %
$str11% 6
,116 7
x118 9
=>11: <
x11= >
.11> ?
Id11? A
)11A B
;11B C
}22 
)22 
;22 
migrationBuilder44 
.44 
CreateTable44 (
(44( )
name55 
:55 
reserva55 
,55 
columns66 
:66 
table66 
=>66 !
new66" %
{77 
Id88 
=88 
table88 
.88 
Column88 %
<88% &
int88& )
>88) *
(88* +
type88+ /
:88/ 0
$str881 6
,886 7
nullable888 @
:88@ A
false88B G
)88G H
.99 

Annotation99 #
(99# $
sql99$ '
,99' (
$str99) /
)99/ 0
,990 1
	ClienteId:: 
=:: 
table::  %
.::% &
Column::& ,
<::, -
int::- 0
>::0 1
(::1 2
type::2 6
:::6 7
$str::8 =
,::= >
nullable::? G
:::G H
false::I N
)::N O
,::O P
HabitacionId;;  
=;;! "
table;;# (
.;;( )
Column;;) /
<;;/ 0
int;;0 3
>;;3 4
(;;4 5
type;;5 9
:;;9 :
$str;;; @
,;;@ A
nullable;;B J
:;;J K
false;;L Q
);;Q R
,;;R S
FechaDeReserva<< "
=<<# $
table<<% *
.<<* +
Column<<+ 1
<<<1 2
DateTime<<2 :
><<: ;
(<<; <
type<<< @
:<<@ A
$str<<B M
,<<M N
nullable<<O W
:<<W X
false<<Y ^
)<<^ _
,<<_ `
FechaDeInicio== !
===" #
table==$ )
.==) *
Column==* 0
<==0 1
DateTime==1 9
>==9 :
(==: ;
type==; ?
:==? @
$str==A L
,==L M
nullable==N V
:==V W
false==X ]
)==] ^
,==^ _

FechaDeFin>> 
=>>  
table>>! &
.>>& '
Column>>' -
<>>- .
DateTime>>. 6
>>>6 7
(>>7 8
type>>8 <
:>>< =
$str>>> I
,>>I J
nullable>>K S
:>>S T
false>>U Z
)>>Z [
}?? 
,?? 
constraints@@ 
:@@ 
table@@ "
=>@@# %
{AA 
tableBB 
.BB 

PrimaryKeyBB $
(BB$ %
$strBB% 2
,BB2 3
xBB4 5
=>BB6 8
xBB9 :
.BB: ;
IdBB; =
)BB= >
;BB> ?
tableCC 
.CC 

ForeignKeyCC $
(CC$ %
nameDD 
:DD 
$strDD >
,DD> ?
columnEE 
:EE 
xEE  !
=>EE" $
xEE% &
.EE& '
	ClienteIdEE' 0
,EE0 1
principalTableFF &
:FF& '
$strFF( 2
,FF2 3
principalColumnGG '
:GG' (
$strGG) -
,GG- .
onDeleteHH  
:HH  !
ReferentialActionHH" 3
.HH3 4
CascadeHH4 ;
)HH; <
;HH< =
tableII 
.II 

ForeignKeyII $
(II$ %
nameJJ 
:JJ 
$strJJ E
,JJE F
columnKK 
:KK 
xKK  !
=>KK" $
xKK% &
.KK& '
HabitacionIdKK' 3
,KK3 4
principalTableLL &
:LL& '
$strLL( 6
,LL6 7
principalColumnMM '
:MM' (
$strMM) -
,MM- .
onDeleteNN  
:NN  !
ReferentialActionNN" 3
.NN3 4
CascadeNN4 ;
)NN; <
;NN< =
}OO 
)OO 
;OO 
migrationBuilderQQ 
.QQ 
CreateTableQQ (
(QQ( )
nameRR 
:RR 
$strRR ,
,RR, -
columnsSS 
:SS 
tableSS 
=>SS !
newSS" %
{TT 
IdUU 
=UU 
tableUU 
.UU 
ColumnUU %
<UU% &
intUU& )
>UU) *
(UU* +
typeUU+ /
:UU/ 0
$strUU1 6
,UU6 7
nullableUU8 @
:UU@ A
falseUUB G
)UUG H
.VV 

AnnotationVV #
(VV# $
sqlVV$ '
,VV' (
$strVV) /
)VV/ 0
,VV0 1
DescripcionWW 
=WW  !
tableWW" '
.WW' (
ColumnWW( .
<WW. /
stringWW/ 5
>WW5 6
(WW6 7
typeWW7 ;
:WW; <
nvarCharWW= E
,WWE F
nullableWWG O
:WWO P
falseWWQ V
)WWV W
,WWW X
CostoXX 
=XX 
tableXX !
.XX! "
ColumnXX" (
<XX( )
decimalXX) 0
>XX0 1
(XX1 2
typeXX2 6
:XX6 7
$strXX8 G
,XXG H
nullableXXI Q
:XXQ R
falseXXS X
)XXX Y
,XXY Z
	ReservaIdYY 
=YY 
tableYY  %
.YY% &
ColumnYY& ,
<YY, -
intYY- 0
>YY0 1
(YY1 2
typeYY2 6
:YY6 7
$strYY8 =
,YY= >
nullableYY? G
:YYG H
falseYYI N
)YYN O
}ZZ 
,ZZ 
constraints[[ 
:[[ 
table[[ "
=>[[# %
{\\ 
table]] 
.]] 

PrimaryKey]] $
(]]$ %
$str]]% >
,]]> ?
x]]@ A
=>]]B D
x]]E F
.]]F G
Id]]G I
)]]I J
;]]J K
table^^ 
.^^ 

ForeignKey^^ $
(^^$ %
name__ 
:__ 
$str__ J
,__J K
column`` 
:`` 
x``  !
=>``" $
x``% &
.``& '
	ReservaId``' 0
,``0 1
principalTableaa &
:aa& '
reservaaa( /
,aa/ 0
principalColumnbb '
:bb' (
$strbb) -
,bb- .
onDeletecc  
:cc  !
ReferentialActioncc" 3
.cc3 4
Cascadecc4 ;
)cc; <
;cc< =
}dd 
)dd 
;dd 
migrationBuilderff 
.ff 
CreateIndexff (
(ff( )
namegg 
:gg 
$strgg -
,gg- .
tablehh 
:hh 
reservahh 
,hh 
columnii 
:ii 
$strii #
)ii# $
;ii$ %
migrationBuilderkk 
.kk 
CreateIndexkk (
(kk( )
namell 
:ll 
$strll 0
,ll0 1
tablemm 
:mm 
reservamm 
,mm 
columnnn 
:nn 
$strnn &
)nn& '
;nn' (
migrationBuilderpp 
.pp 
CreateIndexpp (
(pp( )
nameqq 
:qq 
$strqq 9
,qq9 :
tablerr 
:rr 
$strrr -
,rr- .
columnss 
:ss 
$strss #
)ss# $
;ss$ %
}tt 	
	protectedww 
overrideww 
voidww 
Downww  $
(ww$ %
MigrationBuilderww% 5
migrationBuilderww6 F
)wwF G
{xx 	
migrationBuilderyy 
.yy 
	DropTableyy &
(yy& '
namezz 
:zz 
$strzz ,
)zz, -
;zz- .
migrationBuilder|| 
.|| 
	DropTable|| &
(||& '
name}} 
:}} 
reserva}} 
)}} 
;}} 
migrationBuilder 
. 
	DropTable &
(& '
name
€€ 
:
€€ 
$str
€€  
)
€€  !
;
€€! "
migrationBuilder
‚‚ 
.
‚‚ 
	DropTable
‚‚ &
(
‚‚& '
name
ƒƒ 
:
ƒƒ 
$str
ƒƒ $
)
ƒƒ$ %
;
ƒƒ% &
}
„„ 	
}
…… 
}†† ó]
eC:\Users\danie\source\repos\prueba2P-Pruebas\Prueba\Prueba\Controllers\ServicioAdicionalController.cs
	namespace 	
Prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class '
ServicioAdicionalController ,
:- .
ControllerBase/ =
{		 
private

 
readonly

 
AppDBContext

 %
_appDbContext

& 3
;

3 4
public '
ServicioAdicionalController *
(* +
AppDBContext+ 7
appDbContext8 D
)D E
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
private 

IQueryable 
< 
ServicioAdicional ,
>, -/
#GetServiciosAdicionalesWithIncludes. Q
(Q R
)R S
{ 	
return 
_appDbContext  
.  ! 
ServiciosAdicionales! 5
. 
Include 
( 
s 
=> 
s 
.  
Reserva  '
)' (
. 
ThenInclude 
( 
r 
=> !
r" #
.# $
Cliente$ +
)+ ,
. 
Include 
( 
s 
=> 
s 
.  
Reserva  '
.' (

Habitacion( 2
)2 3
;3 4
} 	
private 
async 
Task 
< 
( 
bool  
isValid! (
,( )
string* 0
message1 8
)8 9
>9 :%
ValidateServicioAdicional; T
(T U
ServicioAdicionalU f
serviciog o
)o p
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
servicio* 2
.2 3
Descripcion3 >
)> ?
)? @
return 
( 
false 
, 
$str K
)K L
;L M
var    
descripcionExistente   $
=  % &
await  ' ,
_appDbContext  - :
.  : ; 
ServiciosAdicionales  ; O
.!! 
AnyAsync!! 
(!! 
s!! 
=>!! 
s!!  
.!!  !
Descripcion!!! ,
==!!- /
servicio!!0 8
.!!8 9
Descripcion!!9 D
)!!D E
;!!E F
if## 
(##  
descripcionExistente## $
)##$ %
return$$ 
($$ 
false$$ 
,$$ 
$str$$ Y
)$$Y Z
;$$Z [
if&& 
(&& 
servicio&& 
.&& 
Costo&& 
<=&& !
$num&&" #
||&&$ &
servicio&&' /
.&&/ 0
Costo&&0 5
>&&6 7
$num&&8 ;
)&&; <
return'' 
('' 
false'' 
,'' 
$str'' @
)''@ A
;''A B
var)) 
reserva)) 
=)) 
await)) 
_appDbContext))  -
.))- .
Reservas)). 6
.** 
Include** 
(** 
r** 
=>** 
r** 
.**  
Cliente**  '
)**' (
.++ 
Include++ 
(++ 
r++ 
=>++ 
r++ 
.++  

Habitacion++  *
)++* +
.,, 
FirstOrDefaultAsync,, $
(,,$ %
r,,% &
=>,,' )
r,,* +
.,,+ ,
Id,,, .
==,,/ 1
servicio,,2 :
.,,: ;
Reserva,,; B
.,,B C
Id,,C E
),,E F
;,,F G
if.. 
(.. 
reserva.. 
==.. 
null.. 
)..  
return// 
(// 
false// 
,// 
$str// >
)//> ?
;//? @
servicio11 
.11 
Reserva11 
=11 
reserva11 &
;11& '
return22 
(22 
true22 
,22 
string22  
.22  !
Empty22! &
)22& '
;22' (
}33 	
[55 	
HttpGet55	 
]55 
public66 
async66 
Task66 
<66 
IActionResult66 '
>66' (#
GetServiciosAdicionales66) @
(66@ A
)66A B
{77 	
var88 
	servicios88 
=88 
await88 !/
#GetServiciosAdicionalesWithIncludes88" E
(88E F
)88F G
.88G H
ToListAsync88H S
(88S T
)88T U
;88U V
return99 
Ok99 
(99 
	servicios99 
)99  
;99  !
}:: 	
[<< 	
HttpGet<<	 
(<< 
$str<< 
)<< 
]<< 
public== 
async== 
Task== 
<== 
IActionResult== '
>==' ( 
GetServicioAdicional==) =
(=== >
int==> A
id==B D
)==D E
{>> 	
var?? 
servicio?? 
=?? 
await??  /
#GetServiciosAdicionalesWithIncludes??! D
(??D E
)??E F
.@@ 
FirstOrDefaultAsync@@ $
(@@$ %
s@@% &
=>@@' )
s@@* +
.@@+ ,
Id@@, .
==@@/ 1
id@@2 4
)@@4 5
;@@5 6
ifBB 
(BB 
servicioBB 
==BB 
nullBB  
)BB  !
returnBB" (
OkBB) +
(BB+ ,
$strBB, C
)BBC D
;BBD E
returnCC 
OkCC 
(CC 
servicioCC 
)CC 
;CC  
}DD 	
[FF 	
HttpPostFF	 
]FF 
publicGG 
asyncGG 
TaskGG 
<GG 
IActionResultGG '
>GG' (#
CreateServicioAdicionalGG) @
(GG@ A
ServicioAdicionalGGA R
servicioGGS [
)GG[ \
{HH 	
varII 
(II 
isValidII 
,II 
messageII !
)II! "
=II# $
awaitII% *%
ValidateServicioAdicionalII+ D
(IID E
servicioIIE M
)IIM N
;IIN O
ifJJ 
(JJ 
!JJ 
isValidJJ 
)JJ 
returnJJ  
OkJJ! #
(JJ# $
messageJJ$ +
)JJ+ ,
;JJ, -
awaitLL 
_appDbContextLL 
.LL   
ServiciosAdicionalesLL  4
.LL4 5
AddAsyncLL5 =
(LL= >
servicioLL> F
)LLF G
;LLG H
awaitMM 
_appDbContextMM 
.MM  
SaveChangesAsyncMM  0
(MM0 1
)MM1 2
;MM2 3
varOO 
servicioCreadoOO 
=OO  
awaitOO! &/
#GetServiciosAdicionalesWithIncludesOO' J
(OOJ K
)OOK L
.PP 
FirstOrDefaultAsyncPP $
(PP$ %
sPP% &
=>PP' )
sPP* +
.PP+ ,
IdPP, .
==PP/ 1
servicioPP2 :
.PP: ;
IdPP; =
)PP= >
;PP> ?
returnRR 
OkRR 
(RR 
servicioCreadoRR $
)RR$ %
;RR% &
}SS 	
[UU 	
HttpPutUU	 
(UU 
$strUU 
)UU 
]UU 
publicVV 
asyncVV 
TaskVV 
<VV 
IActionResultVV '
>VV' (!
EditServicioAdicionalVV) >
(VV> ?
intVV? B
idVVC E
,VVE F
ServicioAdicionalVVG X
servicioVVY a
)VVa b
{WW 	
ifXX 
(XX 
idXX 
!=XX 
servicioXX 
.XX 
IdXX !
)XX! "
returnXX# )
OkXX* ,
(XX, -
$strXX- W
)XXW X
;XXX Y
varZZ 
servicioExistenteZZ !
=ZZ" #
awaitZZ$ )/
#GetServiciosAdicionalesWithIncludesZZ* M
(ZZM N
)ZZN O
.[[ 
FirstOrDefaultAsync[[ $
([[$ %
s[[% &
=>[[' )
s[[* +
.[[+ ,
Id[[, .
==[[/ 1
id[[2 4
)[[4 5
;[[5 6
if]] 
(]] 
servicioExistente]] !
==]]" $
null]]% )
)]]) *
return]]+ 1
Ok]]2 4
(]]4 5
$str]]5 V
)]]V W
;]]W X
var__ 
(__ 
isValid__ 
,__ 
message__ !
)__! "
=__# $
await__% *%
ValidateServicioAdicional__+ D
(__D E
servicio__E M
)__M N
;__N O
if`` 
(`` 
!`` 
isValid`` 
)`` 
return``  
Ok``! #
(``# $
message``$ +
)``+ ,
;``, -
servicioExistentebb 
.bb 
Descripcionbb )
=bb* +
serviciobb, 4
.bb4 5
Descripcionbb5 @
;bb@ A
servicioExistentecc 
.cc 
Costocc #
=cc$ %
serviciocc& .
.cc. /
Costocc/ 4
;cc4 5
servicioExistentedd 
.dd 
Reservadd %
=dd& '
serviciodd( 0
.dd0 1
Reservadd1 8
;dd8 9
_appDbContextff 
.ff  
ServiciosAdicionalesff .
.ff. /
Updateff/ 5
(ff5 6
servicioExistenteff6 G
)ffG H
;ffH I
awaitgg 
_appDbContextgg 
.gg  
SaveChangesAsyncgg  0
(gg0 1
)gg1 2
;gg2 3
varii 
servicioActualizadoii #
=ii$ %
awaitii& +/
#GetServiciosAdicionalesWithIncludesii, O
(iiO P
)iiP Q
.jj 
FirstOrDefaultAsyncjj $
(jj$ %
sjj% &
=>jj' )
sjj* +
.jj+ ,
Idjj, .
==jj/ 1
idjj2 4
)jj4 5
;jj5 6
returnll 
Okll 
(ll 
servicioActualizadoll )
)ll) *
;ll* +
}mm 	
[oo 	

HttpDeleteoo	 
(oo 
$stroo 
)oo 
]oo 
publicpp 
asyncpp 
Taskpp 
<pp 
IActionResultpp '
>pp' (#
DeleteServicioAdicionalpp) @
(pp@ A
intppA D
idppE G
)ppG H
{qq 	
varrr 
serviciorr 
=rr 
awaitrr  
_appDbContextrr! .
.rr. / 
ServiciosAdicionalesrr/ C
.rrC D
	FindAsyncrrD M
(rrM N
idrrN P
)rrP Q
;rrQ R
iftt 
(tt 
serviciott 
==tt 
nulltt  
)tt  !
returntt" (
Oktt) +
(tt+ ,
$strtt, M
)ttM N
;ttN O
_appDbContextvv 
.vv  
ServiciosAdicionalesvv .
.vv. /
Removevv/ 5
(vv5 6
serviciovv6 >
)vv> ?
;vv? @
awaitww 
_appDbContextww 
.ww  
SaveChangesAsyncww  0
(ww0 1
)ww1 2
;ww2 3
returnyy 
Okyy 
(yy 
newyy 
{yy 
messageyy #
=yy$ %
$"yy& (
$stryy( B
{yyB C
idyyC E
}yyE F
$stryyF ^
"yy^ _
}yy` a
)yya b
;yyb c
}zz 	
}{{ 
}|| Ôa
[C:\Users\danie\source\repos\prueba2P-Pruebas\Prueba\Prueba\Controllers\ReservaController.cs
	namespace 	
Prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
ReservaController "
:# $
ControllerBase% 3
{		 
private

 
readonly

 
AppDBContext

 %
_appDbContext

& 3
;

3 4
public 
ReservaController  
(  !
AppDBContext! -
appDbContext. :
): ;
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetReservas) 4
(4 5
)5 6
{ 	
var 
reservas 
= 
await  
_appDbContext! .
.. /
Reservas/ 7
. 
Include 
( 
r 
=> 
r 
.  
Cliente  '
)' (
. 
Include 
( 
r 
=> 
r 
.  

Habitacion  *
)* +
. 
ToListAsync 
( 
) 
; 
return 
Ok 
( 
reservas 
) 
;  
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (

GetReserva) 3
(3 4
int4 7
id8 :
): ;
{ 	
var 
reserva 
= 
await 
_appDbContext  -
.- .
Reservas. 6
. 
Include 
( 
r 
=> 
r 
.  
Cliente  '
)' (
.   
Include   
(   
r   
=>   
r   
.    

Habitacion    *
)  * +
.!! 
FirstOrDefaultAsync!! $
(!!$ %
r!!% &
=>!!' )
r!!* +
.!!+ ,
Id!!, .
==!!/ 1
id!!2 4
)!!4 5
;!!5 6
if## 
(## 
reserva## 
==## 
null## 
)##  
return##! '
Ok##( *
(##* +
$str##+ A
)##A B
;##B C
return%% 
Ok%% 
(%% 
reserva%% 
)%% 
;%% 
}&& 	
[(( 	
HttpPost((	 
](( 
public)) 
async)) 
Task)) 
<)) 
IActionResult)) '
>))' (
CreateReserva))) 6
())6 7
Reserva))7 >
reserva))? F
)))F G
{** 	
var++ 
validationResult++  
=++! "
await++# (
validar++) 0
(++0 1
reserva++1 8
)++8 9
;++9 :
if,, 
(,, 
validationResult,,  
!=,,! #
null,,$ (
),,( )
{-- 
return.. 
validationResult.. '
;..' (
}// 
_appDbContext11 
.11 
Reservas11 "
.11" #
Add11# &
(11& '
reserva11' .
)11. /
;11/ 0
await22 
_appDbContext22 
.22  
SaveChangesAsync22  0
(220 1
)221 2
;222 3
return44 
Ok44 
(44 
reserva44 
)44 
;44 
}66 	
[88 	
HttpPut88	 
(88 
$str88 
)88 
]88 
public99 
async99 
Task99 
<99 
IActionResult99 '
>99' (
EditReserva99) 4
(994 5
int995 8
id999 ;
,99; <
Reserva99= D
reserva99E L
)99L M
{:: 	
if;; 
(;; 
id;; 
!=;; 
reserva;; 
.;; 
Id;;  
);;  !
return;;" (
Ok;;) +
(;;+ ,
$str;;, M
);;M N
;;;N O
var== 
reservaExistente==  
===! "
await==# (
_appDbContext==) 6
.==6 7
Reservas==7 ?
.>> 
Include>> 
(>> 
r>> 
=>>> 
r>> 
.>>  
Cliente>>  '
)>>' (
.?? 
Include?? 
(?? 
r?? 
=>?? 
r?? 
.??  

Habitacion??  *
)??* +
.@@ 
FirstOrDefaultAsync@@ $
(@@$ %
r@@% &
=>@@' )
r@@* +
.@@+ ,
Id@@, .
==@@/ 1
id@@2 4
)@@4 5
;@@5 6
ifBB 
(BB 
reservaExistenteBB  
==BB! #
nullBB$ (
)BB( )
returnBB* 0
OkBB1 3
(BB3 4
$strBB4 J
)BBJ K
;BBK L
varDD 
validationResultDD  
=DD! "
awaitDD# (
validarDD) 0
(DD0 1
reservaDD1 8
,DD8 9
excludeReservaIdDD: J
:DDJ K
idDDL N
)DDN O
;DDO P
ifEE 
(EE 
validationResultEE  
!=EE! #
nullEE$ (
)EE( )
{FF 
returnGG 
validationResultGG '
;GG' (
}HH 
reservaExistenteJJ 
.JJ 
ClienteJJ $
=JJ% &
reservaJJ' .
.JJ. /
ClienteJJ/ 6
;JJ6 7
reservaExistenteKK 
.KK 

HabitacionKK '
=KK( )
reservaKK* 1
.KK1 2

HabitacionKK2 <
;KK< =
reservaExistenteLL 
.LL 
FechaDeReservaLL +
=LL, -
reservaLL. 5
.LL5 6
FechaDeReservaLL6 D
;LLD E
reservaExistenteMM 
.MM 
FechaDeInicioMM *
=MM+ ,
reservaMM- 4
.MM4 5
FechaDeInicioMM5 B
;MMB C
reservaExistenteNN 
.NN 

FechaDeFinNN '
=NN( )
reservaNN* 1
.NN1 2

FechaDeFinNN2 <
;NN< =
_appDbContextPP 
.PP 
ReservasPP "
.PP" #
UpdatePP# )
(PP) *
reservaExistentePP* :
)PP: ;
;PP; <
awaitQQ 
_appDbContextQQ 
.QQ  
SaveChangesAsyncQQ  0
(QQ0 1
)QQ1 2
;QQ2 3
returnSS 
OkSS 
(SS 
reservaExistenteSS &
)SS& '
;SS' (
}TT 	
[VV 	

HttpDeleteVV	 
(VV 
$strVV 
)VV 
]VV 
publicWW 
asyncWW 
TaskWW 
<WW 
IActionResultWW '
>WW' (
DeleteReservaWW) 6
(WW6 7
intWW7 :
idWW; =
)WW= >
{XX 	
varYY 
reservaYY 
=YY 
awaitYY 
_appDbContextYY  -
.YY- .
ReservasYY. 6
.YY6 7
	FindAsyncYY7 @
(YY@ A
idYYA C
)YYC D
;YYD E
ifZZ 
(ZZ 
reservaZZ 
==ZZ 
nullZZ 
)ZZ  
returnZZ! '
OkZZ( *
(ZZ* +
$strZZ+ A
)ZZA B
;ZZB C
_appDbContext\\ 
.\\ 
Reservas\\ "
.\\" #
Remove\\# )
(\\) *
reserva\\* 1
)\\1 2
;\\2 3
await]] 
_appDbContext]] 
.]]  
SaveChangesAsync]]  0
(]]0 1
)]]1 2
;]]2 3
return__ 
Ok__ 
(__ 
new__ 
{__ 
message__ #
=__$ %
$"__& (
$str__( 7
{__7 8
id__8 :
}__: ;
$str__; S
"__S T
}__U V
)__V W
;__W X
}`` 	
privatebb 
asyncbb 
Taskbb 
<bb 
IActionResultbb (
?bb( )
>bb) *
validarbb+ 2
(bb2 3
Reservabb3 :
reservabb; B
,bbB C
intbbD G
?bbG H
excludeReservaIdbbI Y
=bbZ [
nullbb\ `
)bb` a
{cc 	
vardd 
clientedd 
=dd 
awaitdd 
_appDbContextdd  -
.dd- .
Clientesdd. 6
.dd6 7
	FindAsyncdd7 @
(dd@ A
reservaddA H
.ddH I
ClienteddI P
.ddP Q
IdddQ S
)ddS T
;ddT U
varee 

habitacionee 
=ee 
awaitee "
_appDbContextee# 0
.ee0 1
Habitacionesee1 =
.ee= >
	FindAsyncee> G
(eeG H
reservaeeH O
.eeO P

HabitacioneeP Z
.eeZ [
Idee[ ]
)ee] ^
;ee^ _
ifgg 
(gg 

habitaciongg 
==gg 
nullgg "
)gg" #
{hh 
returnii 
Okii 
(ii 
$strii 0
)ii0 1
;ii1 2
}jj 
ifll 
(ll 
clientell 
==ll 
nullll 
)ll  
{mm 
returnnn 
Oknn 
(nn 
$strnn -
)nn- .
;nn. /
}oo 
ifqq 
(qq 
reservaqq 
.qq 
FechaDeInicioqq %
<qq& '
reservaqq( /
.qq/ 0
FechaDeReservaqq0 >
)qq> ?
{rr 
returnss 
Okss 
(ss 
$strss Z
)ssZ [
;ss[ \
}tt 
ifvv 
(vv 
reservavv 
.vv 

FechaDeFinvv "
<=vv# %
reservavv& -
.vv- .
FechaDeIniciovv. ;
)vv; <
{ww 
returnxx 
Okxx 
(xx 
$strxx S
)xxS T
;xxT U
}yy 
var{{ 
	conflicto{{ 
={{ 
await{{ !
_appDbContext{{" /
.{{/ 0
Reservas{{0 8
.{{8 9
AnyAsync{{9 A
(|| 
r|| 
=>|| 
r|| 
.|| 

Habitacion|| "
.||" #
Id||# %
==||& (

habitacion||) 3
.||3 4
Id||4 6
&&||7 9
(}} 
!}} 
excludeReservaId}} "
.}}" #
HasValue}}# +
||}}, .
r}}/ 0
.}}0 1
Id}}1 3
!=}}4 6
excludeReservaId}}7 G
)}}G H
&&}}I K
(~~ 
(~~ 
reserva~~ 
.~~ 
FechaDeInicio~~ '
>=~~( *
r~~+ ,
.~~, -
FechaDeInicio~~- :
&&~~; =
reserva~~> E
.~~E F
FechaDeInicio~~F S
<~~T U
r~~V W
.~~W X

FechaDeFin~~X b
)~~b c
||~~d f
( 
reserva 
. 

FechaDeFin #
>$ %
r& '
.' (
FechaDeInicio( 5
&&6 8
reserva9 @
.@ A

FechaDeFinA K
<=L N
rO P
.P Q

FechaDeFinQ [
)[ \
)\ ]
)] ^
;^ _
if
 
(
 
	conflicto
 
)
 
{
‚‚ 
return
ƒƒ 
Ok
ƒƒ 
(
ƒƒ 
$str
ƒƒ X
)
ƒƒX Y
;
ƒƒY Z
}
„„ 
reserva
†† 
.
†† 
Cliente
†† 
=
†† 
cliente
†† %
;
††% &
reserva
‡‡ 
.
‡‡ 

Habitacion
‡‡ 
=
‡‡  

habitacion
‡‡! +
;
‡‡+ ,
return
‰‰ 
null
‰‰ 
;
‰‰ 
}
ŠŠ 	
}
‹‹ 
}ŒŒ ç]
^C:\Users\danie\source\repos\prueba2P-Pruebas\Prueba\Prueba\Controllers\HabitacionController.cs
	namespace 	
Prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class  
HabitacionController %
:& '
ControllerBase( 6
{		 
private

 
readonly

 
AppDBContext

 %
_appDbContext

& 3
;

3 4
public  
HabitacionController #
(# $
AppDBContext$ 0
appDbContext1 =
)= >
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetHabitaciones) 8
(8 9
)9 :
{ 	
var 
habitaciones 
= 
await $
_appDbContext% 2
.2 3
Habitaciones3 ?
.? @
ToListAsync@ K
(K L
)L M
;M N
return 
Ok 
( 
habitaciones "
)" #
;# $
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetHabitacion) 6
(6 7
int7 :
id; =
)= >
{ 	
var 

habitacion 
= 
await "
_appDbContext# 0
.0 1
Habitaciones1 =
.= >
	FindAsync> G
(G H
idH J
)J K
;K L
if 
( 

habitacion 
== 
null "
)" #
return$ *
Ok+ -
(- .
$str. G
)G H
;H I
return 
Ok 
( 

habitacion  
)  !
;! "
} 	
[   	
HttpPost  	 
]   
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
CreateHabitacion!!) 9
(!!9 :

Habitacion!!: D

habitacion!!E O
)!!O P
{"" 	
if%% 
(%% 

habitacion%% 
.%% 
	Capacidad%% $
==%%% '
null%%( ,
||%%- /

habitacion%%0 :
.%%: ;
	Capacidad%%; D
<=%%E G
$num%%H I
||%%J L

habitacion%%M W
.%%W X
	Capacidad%%X a
>=%%b d
$num%%e f
)%%f g
{&& 
return'' 
Ok'' 
('' 
$str'' =
)''= >
;''> ?
}(( 
if++ 
(++ 

habitacion++ 
.++ 
NumeroDeHabitacion++ -
==++. 0
null++1 5
||++6 8

habitacion++9 C
.++C D
NumeroDeHabitacion++D V
<=++W Y
$num++Z [
||++\ ^

habitacion++_ i
.++i j
NumeroDeHabitacion++j |
>++} ~
$num	++ ‚
)
++‚ ƒ
{,, 
return-- 
Ok-- 
(-- 
$str-- T
)--T U
;--U V
}.. 
var00 
habitacionExistente00 #
=00$ %
await00& +
_appDbContext00, 9
.009 :
Habitaciones00: F
.00F G
FirstOrDefaultAsync00G Z
(00Z [
h00[ \
=>00] _
h00` a
.00a b
NumeroDeHabitacion00b t
==00u w

habitacion	00x ‚
.
00‚ ƒ 
NumeroDeHabitacion
00ƒ •
)
00• –
;
00– —
if11 
(11 
habitacionExistente11 #
!=11$ &
null11' +
)11+ ,
{22 
return33 
Ok33 
(33 
$str33 I
)33I J
;33J K
}44 
if66 
(66 

habitacion66 
.66 
Costo66  
<66! "
$num66# %
||66& (

habitacion66) 3
.663 4
Costo664 9
>66: ;
$num66< ?
)66? @
{77 
return88 
Ok88 
(88 
$str88 <
)88< =
;88= >
}99 
if<< 
(<< 

habitacion<< 
.<< 
Piso<< 
!=<<  "
null<<# '
&&<<( *

habitacion<<+ 5
.<<5 6
Piso<<6 :
<<<; <
$num<<= >
||<<? A

habitacion<<B L
.<<L M
Piso<<M Q
><<R S
$num<<T V
)<<V W
{== 
return>> 
Ok>> 
(>> 
$str>> 9
)>>9 :
;>>: ;
}?? 
_appDbContextAA 
.AA 
HabitacionesAA &
.AA& '
AddAA' *
(AA* +

habitacionAA+ 5
)AA5 6
;AA6 7
awaitBB 
_appDbContextBB 
.BB  
SaveChangesAsyncBB  0
(BB0 1
)BB1 2
;BB2 3
returnCC 
OkCC 
(CC 

habitacionCC  
)CC  !
;CC! "
}EE 	
[GG 	
HttpPutGG	 
(GG 
$strGG 
)GG 
]GG 
publicHH 
asyncHH 
TaskHH 
<HH 
IActionResultHH '
>HH' (
EditHabitacionHH) 7
(HH7 8
intHH8 ;
idHH< >
,HH> ?

HabitacionHH@ J

habitacionHHK U
)HHU V
{II 	
ifJJ 
(JJ 
idJJ 
!=JJ 

habitacionJJ  
.JJ  !
IdJJ! #
)JJ# $
returnJJ% +
OkJJ, .
(JJ. /
$strJJ/ S
)JJS T
;JJT U
varLL 
habitacionExistenteLL #
=LL$ %
awaitLL& +
_appDbContextLL, 9
.LL9 :
HabitacionesLL: F
.LLF G
	FindAsyncLLG P
(LLP Q
idLLQ S
)LLS T
;LLT U
ifMM 
(MM 
habitacionExistenteMM #
==MM$ &
nullMM' +
)MM+ ,
returnMM- 3
OkMM4 6
(MM6 7
$strMM7 P
)MMP Q
;MMQ R
ifPP 
(PP 

habitacionPP 
.PP 
	CapacidadPP $
==PP% '
nullPP( ,
||PP- /

habitacionPP0 :
.PP: ;
	CapacidadPP; D
<=PPE G
$numPPH I
||PPJ L

habitacionPPM W
.PPW X
	CapacidadPPX a
>=PPb d
$numPPe f
)PPf g
{QQ 
returnRR 
OkRR 
(RR 
$strRR =
)RR= >
;RR> ?
}SS 
ifVV 
(VV 

habitacionVV 
.VV 
NumeroDeHabitacionVV -
==VV. 0
nullVV1 5
||VV6 8

habitacionVV9 C
.VVC D
NumeroDeHabitacionVVD V
<=VVW Y
$numVVZ [
||VV\ ^

habitacionVV_ i
.VVi j
NumeroDeHabitacionVVj |
>VV} ~
$num	VV ‚
)
VV‚ ƒ
{WW 
returnXX 
OkXX 
(XX 
$strXX T
)XXT U
;XXU V
}YY 
var[[ 
otraHabitacion[[ 
=[[  
await[[! &
_appDbContext[[' 4
.[[4 5
Habitaciones[[5 A
.[[A B
FirstOrDefaultAsync[[B U
([[U V
h[[V W
=>[[X Z
h[[[ \
.[[\ ]
NumeroDeHabitacion[[] o
==[[p r

habitacion[[s }
.[[} ~
NumeroDeHabitacion	[[~ 
&&
[[‘ “
h
[[” •
.
[[• –
Id
[[– ˜
!=
[[™ ›
id
[[œ ž
)
[[ž Ÿ
;
[[Ÿ  
if\\ 
(\\ 
otraHabitacion\\ 
!=\\ !
null\\" &
)\\& '
{]] 
return^^ 
Ok^^ 
(^^ 
$str^^ J
)^^J K
;^^K L
}__ 
ifaa 
(aa 

habitacionaa 
.aa 
Costoaa  
<=aa! #
$numaa$ %
||aa& (

habitacionaa) 3
.aa3 4
Costoaa4 9
>aa: ;
$numaa< ?
)aa? @
{bb 
returncc 
Okcc 
(cc 
$strcc ;
)cc; <
;cc< =
}dd 
ifgg 
(gg 

habitaciongg 
.gg 
Pisogg 
!=gg  "
nullgg# '
&&gg( *

habitaciongg+ 5
.gg5 6
Pisogg6 :
<gg; <
$numgg= >
||gg? A

habitacionggB L
.ggL M
PisoggM Q
>ggR S
$numggT V
)ggV W
{hh 
returnii 
Okii 
(ii 
$strii 9
)ii9 :
;ii: ;
}jj 
habitacionExistentenn 
.nn  
	Capacidadnn  )
=nn* +

habitacionnn, 6
.nn6 7
	Capacidadnn7 @
;nn@ A
habitacionExistenteoo 
.oo  
NumeroDeHabitacionoo  2
=oo3 4

habitacionoo5 ?
.oo? @
NumeroDeHabitacionoo@ R
;ooR S
habitacionExistentepp 
.pp  
Costopp  %
=pp& '

habitacionpp( 2
.pp2 3
Costopp3 8
;pp8 9
habitacionExistenteqq 
.qq  
Pisoqq  $
=qq% &

habitacionqq' 1
.qq1 2
Pisoqq2 6
;qq6 7
habitacionExistenterr 
.rr  
Lugarrr  %
=rr& '

habitacionrr( 2
.rr2 3
Lugarrr3 8
;rr8 9
_appDbContexttt 
.tt 
Habitacionestt &
.tt& '
Updatett' -
(tt- .
habitacionExistentett. A
)ttA B
;ttB C
awaituu 
_appDbContextuu 
.uu  
SaveChangesAsyncuu  0
(uu0 1
)uu1 2
;uu2 3
returnww 
Okww 
(ww 
habitacionExistenteww )
)ww) *
;ww* +
}xx 	
[zz 	

HttpDeletezz	 
(zz 
$strzz 
)zz 
]zz 
public{{ 
async{{ 
Task{{ 
<{{ 
IActionResult{{ '
>{{' (
DeleteHabitacion{{) 9
({{9 :
int{{: =
id{{> @
){{@ A
{|| 	
var}} 

habitacion}} 
=}} 
await}} "
_appDbContext}}# 0
.}}0 1
Habitaciones}}1 =
.}}= >
	FindAsync}}> G
(}}G H
id}}H J
)}}J K
;}}K L
if~~ 
(~~ 

habitacion~~ 
==~~ 
null~~ "
)~~" #
return~~$ *
Ok~~+ -
(~~- .
$str~~. G
)~~G H
;~~H I
_appDbContext
€€ 
.
€€ 
Habitaciones
€€ &
.
€€& '
Remove
€€' -
(
€€- .

habitacion
€€. 8
)
€€8 9
;
€€9 :
await
 
_appDbContext
 
.
  
SaveChangesAsync
  0
(
0 1
)
1 2
;
2 3
return
ƒƒ 
Ok
ƒƒ 
(
ƒƒ 
new
ƒƒ 
{
ƒƒ 
message
ƒƒ #
=
ƒƒ$ %
$"
ƒƒ& (
$str
ƒƒ( :
{
ƒƒ: ;
id
ƒƒ; =
}
ƒƒ= >
$str
ƒƒ> V
"
ƒƒV W
}
ƒƒX Y
)
ƒƒY Z
;
ƒƒZ [
}
„„ 	
}
…… 
}†† ým
[C:\Users\danie\source\repos\prueba2P-Pruebas\Prueba\Prueba\Controllers\ClienteController.cs
	namespace 	
Prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
ClienteController "
:# $
ControllerBase% 3
{		 
private

 
readonly

 
AppDBContext

 %
_appDbContext

& 3
;

3 4
public 
ClienteController  
(  !
AppDBContext! -
appDbContext. :
): ;
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetClientes) 4
(4 5
)5 6
{ 	
var 
clientes 
= 
await  
_appDbContext! .
.. /
Clientes/ 7
.7 8
ToListAsync8 C
(C D
)D E
;E F
return 
Ok 
( 
clientes 
) 
;  
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (

GetCliente) 3
(3 4
int4 7
id8 :
): ;
{ 	
var 
cliente 
= 
await 
_appDbContext  -
.- .
Clientes. 6
.6 7
	FindAsync7 @
(@ A
idA C
)C D
;D E
if 
( 
cliente 
== 
null 
)  
return! '
Ok( *
(* +
$str+ A
)A B
;B C
return 
Ok 
( 
cliente 
) 
; 
} 	
[ 	
HttpPost	 
] 
public   
async   
Task   
<   
IActionResult   '
>  ' (
CreateCliente  ) 6
(  6 7
Cliente  7 >
cliente  ? F
)  F G
{!! 	
var"" 
validationResult""  
=""! "
await""# (
ValidarCliente"") 7
(""7 8
cliente""8 ?
)""? @
;""@ A
if## 
(## 
!## 
string## 
.## 
IsNullOrEmpty## %
(##% &
validationResult##& 6
)##6 7
)##7 8
{$$ 
return%% 
Ok%% 
(%% 
validationResult%% *
)%%* +
;%%+ ,
}&& 
_appDbContext(( 
.(( 
Clientes(( "
.((" #
Add((# &
(((& '
cliente((' .
)((. /
;((/ 0
await)) 
_appDbContext)) 
.))  
SaveChangesAsync))  0
())0 1
)))1 2
;))2 3
return** 
Ok** 
(** 
cliente** 
)** 
;** 
}++ 	
[-- 	
HttpPut--	 
(-- 
$str-- 
)-- 
]-- 
public.. 
async.. 
Task.. 
<.. 
IActionResult.. '
>..' (
EditCliente..) 4
(..4 5
int..5 8
id..9 ;
,..; <
Cliente..= D
cliente..E L
)..L M
{// 	
if00 
(00 
id00 
!=00 
cliente00 
.00 
Id00  
)00  !
return00" (
Ok00) +
(00+ ,
$str00, K
)00K L
;00L M
var22 
clienteExistente22  
=22! "
await22# (
_appDbContext22) 6
.226 7
Clientes227 ?
.22? @
	FindAsync22@ I
(22I J
id22J L
)22L M
;22M N
if33 
(33 
clienteExistente33  
==33! #
null33$ (
)33( )
return33* 0
Ok331 3
(333 4
$str334 J
)33J K
;33K L
var55 
validationResult55  
=55! "
await55# (
ValidarCliente55) 7
(557 8
cliente558 ?
,55? @
id55A C
)55C D
;55D E
if66 
(66 
!66 
string66 
.66 
IsNullOrEmpty66 %
(66% &
validationResult66& 6
)666 7
)667 8
{77 
return88 
Ok88 
(88 
validationResult88 *
)88* +
;88+ ,
}99 
clienteExistente;; 
.;; 
Nombre;; #
=;;$ %
cliente;;& -
.;;- .
Nombre;;. 4
;;;4 5
clienteExistente<< 
.<< 
Edad<< !
=<<" #
cliente<<$ +
.<<+ ,
Edad<<, 0
;<<0 1
clienteExistente== 
.== 
Cedula== #
===$ %
cliente==& -
.==- .
Cedula==. 4
;==4 5
_appDbContext?? 
.?? 
Clientes?? "
.??" #
Update??# )
(??) *
clienteExistente??* :
)??: ;
;??; <
await@@ 
_appDbContext@@ 
.@@  
SaveChangesAsync@@  0
(@@0 1
)@@1 2
;@@2 3
returnAA 
OkAA 
(AA 
clienteExistenteAA &
)AA& '
;AA' (
}BB 	
[DD 	

HttpDeleteDD	 
(DD 
$strDD 
)DD 
]DD 
publicEE 
asyncEE 
TaskEE 
<EE 
IActionResultEE '
>EE' (
DeleteClienteEE) 6
(EE6 7
intEE7 :
idEE; =
)EE= >
{FF 	
varGG 
clienteGG 
=GG 
awaitGG 
_appDbContextGG  -
.GG- .
ClientesGG. 6
.GG6 7
	FindAsyncGG7 @
(GG@ A
idGGA C
)GGC D
;GGD E
ifHH 
(HH 
clienteHH 
==HH 
nullHH 
)HH  
returnHH! '
OkHH( *
(HH* +
$strHH+ A
)HHA B
;HHB C
_appDbContextJJ 
.JJ 
ClientesJJ "
.JJ" #
RemoveJJ# )
(JJ) *
clienteJJ* 1
)JJ1 2
;JJ2 3
awaitKK 
_appDbContextKK 
.KK  
SaveChangesAsyncKK  0
(KK0 1
)KK1 2
;KK2 3
returnLL 
OkLL 
(LL 
newLL 
{LL 
messageLL #
=LL$ %
$"LL& (
$strLL( 7
{LL7 8
idLL8 :
}LL: ;
$strLL; [
"LL[ \
}LL] ^
)LL^ _
;LL_ `
}MM 	
privateOO 
staticOO 
boolOO 
EsCedulaValidaOO *
(OO* +
stringOO+ 1
cedulaOO2 8
)OO8 9
{PP 	
ifQQ 
(QQ 
cedulaQQ 
.QQ 
LengthQQ 
!=QQ  
$numQQ! #
||QQ$ &
!QQ' (
cedulaQQ( .
.QQ. /
AllQQ/ 2
(QQ2 3
charQQ3 7
.QQ7 8
IsDigitQQ8 ?
)QQ? @
)QQ@ A
{RR 
returnSS 
falseSS 
;SS 
}TT 
intVV 
	provinciaVV 
=VV 
intVV 
.VV  
ParseVV  %
(VV% &
cedulaVV& ,
.VV, -
	SubstringVV- 6
(VV6 7
$numVV7 8
,VV8 9
$numVV: ;
)VV; <
)VV< =
;VV= >
ifWW 
(WW 
(WW 
	provinciaWW 
<WW 
$numWW 
||WW !
	provinciaWW" +
>WW, -
$numWW. 0
)WW0 1
&&WW2 4
	provinciaWW5 >
!=WW? A
$numWWB D
)WWD E
{XX 
returnYY 
falseYY 
;YY 
}ZZ 
int\\ 
[\\ 
]\\ 
coeficientes\\ 
=\\  
{\\! "
$num\\# $
,\\$ %
$num\\& '
,\\' (
$num\\) *
,\\* +
$num\\, -
,\\- .
$num\\/ 0
,\\0 1
$num\\2 3
,\\3 4
$num\\5 6
,\\6 7
$num\\8 9
,\\9 :
$num\\; <
}\\= >
;\\> ?
int]] 
suma]] 
=]] 
$num]] 
;]] 
for^^ 
(^^ 
int^^ 
i^^ 
=^^ 
$num^^ 
;^^ 
i^^ 
<^^ 
coeficientes^^  ,
.^^, -
Length^^- 3
;^^3 4
i^^5 6
++^^6 8
)^^8 9
{__ 
int`` 
valor`` 
=`` 
coeficientes`` (
[``( )
i``) *
]``* +
*``, -
int``. 1
.``1 2
Parse``2 7
(``7 8
cedula``8 >
[``> ?
i``? @
]``@ A
.``A B
ToString``B J
(``J K
)``K L
)``L M
;``M N
sumaaa 
+=aa 
valoraa 
>=aa  
$numaa! #
?aa$ %
valoraa& +
-aa, -
$numaa. /
:aa0 1
valoraa2 7
;aa7 8
}bb 
intdd 
digitoVerificadordd !
=dd" #
intdd$ '
.dd' (
Parsedd( -
(dd- .
ceduladd. 4
[dd4 5
$numdd5 6
]dd6 7
.dd7 8
ToStringdd8 @
(dd@ A
)ddA B
)ddB C
;ddC D
intee 
residuoee 
=ee 
sumaee 
%ee  
$numee! #
;ee# $
intff 
	resultadoff 
=ff 
residuoff #
==ff$ &
$numff' (
?ff) *
$numff+ ,
:ff- .
$numff/ 1
-ff2 3
residuoff4 ;
;ff; <
returngg 
	resultadogg 
==gg 
digitoVerificadorgg  1
;gg1 2
}hh 	
privatejj 
asyncjj 
Taskjj 
<jj 
stringjj !
?jj! "
>jj" #
ValidarClientejj$ 2
(jj2 3
Clientejj3 :
clientejj; B
,jjB C
intjjD G
?jjG H
idjjI K
=jjL M
nulljjN R
)jjR S
{kk 	
ifll 
(ll 
stringll 
.ll 
IsNullOrWhiteSpacell )
(ll) *
clientell* 1
.ll1 2
Nombrell2 8
)ll8 9
)ll9 :
{mm 
returnnn 
$strnn 1
;nn1 2
}oo 
ifpp 
(pp 
clientepp 
.pp 
Nombrepp 
.pp 
Anypp "
(pp" #
charpp# '
.pp' (
IsDigitpp( /
)pp/ 0
)pp0 1
{qq 
returnrr 
$strrr ;
;rr; <
}ss 
ifuu 
(uu 
stringuu 
.uu 
IsNullOrWhiteSpaceuu )
(uu) *
clienteuu* 1
.uu1 2
Apellidouu2 :
)uu: ;
)uu; <
{vv 
returnww 
$strww 3
;ww3 4
}xx 
ifyy 
(yy 
clienteyy 
.yy 
Apellidoyy  
.yy  !
Anyyy! $
(yy$ %
charyy% )
.yy) *
IsDigityy* 1
)yy1 2
)yy2 3
{zz 
return{{ 
$str{{ =
;{{= >
}|| 
if~~ 
(~~ 
string~~ 
.~~ 
IsNullOrWhiteSpace~~ )
(~~) *
cliente~~* 1
.~~1 2
Cedula~~2 8
)~~8 9
)~~9 :
{ 
return
€€ 
$str
€€ 1
;
€€1 2
}
 
if
‚‚ 
(
‚‚ 
!
‚‚ 
EsCedulaValida
‚‚ 
(
‚‚  
cliente
‚‚  '
.
‚‚' (
Cedula
‚‚( .
)
‚‚. /
)
‚‚/ 0
{
ƒƒ 
return
„„ 
$str
„„ 9
;
„„9 :
}
…… 
if
‡‡ 
(
‡‡ 
cliente
‡‡ 
.
‡‡ 
Edad
‡‡ 
<
‡‡ 
$num
‡‡ !
||
‡‡" $
cliente
‡‡% ,
.
‡‡, -
Edad
‡‡- 1
>
‡‡2 3
$num
‡‡4 6
)
‡‡6 7
{
ˆˆ 
return
‰‰ 
$str
‰‰ V
;
‰‰V W
}
ŠŠ 
var
ŒŒ 
clienteExistente
ŒŒ  
=
ŒŒ! "
await
ŒŒ# (
_appDbContext
ŒŒ) 6
.
ŒŒ6 7
Clientes
ŒŒ7 ?
.
 !
FirstOrDefaultAsync
 $
(
$ %
c
% &
=>
' )
c
* +
.
+ ,
Cedula
, 2
==
3 5
cliente
6 =
.
= >
Cedula
> D
&&
E G
(
H I
!
I J
id
J L
.
L M
HasValue
M U
||
V X
c
Y Z
.
Z [
Id
[ ]
!=
^ `
id
a c
.
c d
Value
d i
)
i j
)
j k
;
k l
if
ŽŽ 
(
ŽŽ 
clienteExistente
ŽŽ  
!=
ŽŽ! #
null
ŽŽ$ (
)
ŽŽ( )
{
 
return
 
$str
 A
;
A B
}
‘‘ 
return
““ 
null
““ 
;
““ 
}
”” 	
}
•• 
}–– .
JC:\Users\danie\source\repos\prueba2P-Pruebas\Prueba\Prueba\AppDBContext.cs
	namespace 	
Prueba
 
{ 
public 

class 
AppDBContext 
: 
	DbContext  )
{ 
public		 
AppDBContext		 
(		 
DbContextOptions		 ,
<		, -
AppDBContext		- 9
>		9 :
options		; B
)		B C
:		D E
base		F J
(		J K
options		K R
)		R S
{		T U
}		V W
public 
DbSet 
< 
Cliente 
> 
Clientes &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 

Habitacion 
>  
Habitaciones! -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
DbSet 
< 
Reserva 
> 
Reservas &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
ServicioAdicional &
>& ' 
ServiciosAdicionales( <
{= >
get? B
;B C
setD G
;G H
}I J
} 
public 

class 
Cliente 
{ 
public 
required 
int 
Id 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
required 
string 
Nombre %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
required 
string 
Apellido '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
int 
? 
Edad 
{ 
get 
; 
set  #
;# $
}% &
public 
required 
string 
Cedula %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
public 

class 

Habitacion 
{ 
public 
required 
int 
Id 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
int 
? 
	Capacidad 
{ 
get  #
;# $
set% (
;( )
}* +
public   
int   
?   
NumeroDeHabitacion   &
{  ' (
get  ) ,
;  , -
set  . 1
;  1 2
}  3 4
[!! 	
JsonRequired!!	 
]!! 
public!! 
decimal!! %
Costo!!& +
{!!, -
get!!. 1
;!!1 2
set!!3 6
;!!6 7
}!!8 9
public"" 
int"" 
?"" 
Piso"" 
{"" 
get"" 
;"" 
set""  #
;""# $
}""% &
public## 
required## 
string## 
Lugar## $
{##% &
get##' *
;##* +
set##, /
;##/ 0
}##1 2
}$$ 
public&& 

class&& 
Reserva&& 
{'' 
public(( 
required(( 
int(( 
Id(( 
{((  
get((! $
;(($ %
set((& )
;(() *
}((+ ,
public)) 
required)) 
Cliente)) 
Cliente))  '
{))( )
get))* -
;))- .
set))/ 2
;))2 3
}))4 5
=))6 7
null))8 <
!))< =
;))= >
public** 
required** 

Habitacion** "

Habitacion**# -
{**. /
get**0 3
;**3 4
set**5 8
;**8 9
}**: ;
=**< =
null**> B
!**B C
;**C D
[++ 	
JsonRequired++	 
]++ 
public++ 
DateTime++ &
FechaDeReserva++' 5
{++6 7
get++8 ;
;++; <
set++= @
;++@ A
}++B C
[,, 	
JsonRequired,,	 
],, 
public,, 
DateTime,, &
FechaDeInicio,,' 4
{,,5 6
get,,7 :
;,,: ;
set,,< ?
;,,? @
},,A B
[-- 	
JsonRequired--	 
]-- 
public-- 
DateTime-- &

FechaDeFin--' 1
{--2 3
get--4 7
;--7 8
set--9 <
;--< =
}--> ?
}.. 
public00 

class00 
ServicioAdicional00 "
{11 
public22 
required22 
int22 
Id22 
{22  
get22! $
;22$ %
set22& )
;22) *
}22+ ,
public33 
required33 
string33 
Descripcion33 *
{33+ ,
get33- 0
;330 1
set332 5
;335 6
}337 8
=339 :
null33; ?
!33? @
;33@ A
[44 	
JsonRequired44	 
]44 
public44 
decimal44 %
Costo44& +
{44, -
get44. 1
;441 2
set443 6
;446 7
}448 9
public55 
required55 
Reserva55 
Reserva55  '
{55( )
get55* -
;55- .
set55/ 2
;552 3
}554 5
=556 7
null558 <
!55< =
;55= >
}66 
}77 